USE WebStor

-- Завдання 1 --

SELECT OFFICE,CITY,MGR 
FROM OFFICES
WHERE SALES >= 350000.00 AND REGION = 'Eastern'

-- Завдання 2 --

SELECT *
FROM ORDERS
WHERE YEAR(ORDER_DATE) NOT BETWEEN 2008 AND 2008
AND (PRODUCT LIKE '_A%' OR PRODUCT LIKE '%0%')

-- Завдання 3 -- 

SELECT MFR, COUNT(DISTINCT ORDER_NUM) AS ORDER_COUNT
FROM ORDERS
WHERE YEAR(ORDER_DATE) <> 2008
AND (PRODUCT LIKE '_A%' OR PRODUCT LIKE '%0%')
GROUP BY MFR
ORDER BY SUM(AMOUNT) ASC;

-- Завдання 4 -- 

SELECT TOP 1 WITH TIES
    MFR,
    SUM(AMOUNT) AS TOTAL_ORDERS
FROM dbo.ORDERS
WHERE YEAR(ORDER_DATE) <> 2008
AND (PRODUCT LIKE '_A%' OR PRODUCT LIKE '%0%')
GROUP BY MFR
ORDER BY SUM(AMOUNT) DESC;

-- Завдання 5 -- 

SELECT TOP 1 WITH TIES
    REP_OFFICE,
    COUNT(*) AS COUNT_EMPLOYEES
FROM SALESREPS
WHERE AGE IN (29, 45, 48)
    AND TITLE = 'Sales Rep'
GROUP BY REP_OFFICE
ORDER BY COUNT(*) DESC;